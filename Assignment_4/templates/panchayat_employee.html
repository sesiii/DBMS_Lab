<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panchayat Employee Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .nav-tabs .nav-link.active {
            background-color: #4CAF50;
            color: white;
        }

        .current-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #4CAF50;
        }

        .form-section {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .table-responsive {
            margin-top: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .header-card {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .info-badge {
            background-color: #e8f5e9;
            color: #2e7d32;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin-right: 10px;
            display: inline-block;
        }

        .btn-custom-primary {
            background-color: #4CAF50;
            border-color: #4CAF50;
            color: white;
        }

        .btn-custom-primary:hover {
            background-color: #45a049;
            border-color: #45a049;
        }

        .accordion-button:not(.collapsed) {
            background-color: #e8f5e9;
            color: #2e7d32;
        }

        .table-hover tbody tr:hover {
            background-color: #f5fff5;
        }
    </style>
</head>

<body>
    <div class="container-fluid py-4">
        <!-- Header Section -->
        <div class="header-card">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1 class="display-4 mb-0">Panchayat Employee Dashboard</h1>
                    <p class="lead mb-0">Welcome, {{ citizen_details.first_name }} {{ citizen_details.last_name }}</p>
                </div>
                <div class="col-md-6">
                    <div class="current-info">

                        <div class="info-badge">
                            <i class="fas fa-user"></i>
                            <strong>User:</strong> {{ citizen_details.first_name }} {{ citizen_details.last_name }}
                        </div>
                        <div class="info-badge">
                            <i class="fas fa-id-badge"></i>
                            <strong>Employee ID:</strong> {{ citizen_details.user_id }}
                        </div>
                        <div class="info-badge"></div>
                        <i class="fas fa-sign-out-alt"></i>
                        <a href="{{ url_for('logout') }}" class="text-decoration-none text-dark">
                            <strong>Logout</strong>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation and Content Section -->
    <div class="row">
        <div class="col-12">
            <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="forms-tab" data-bs-toggle="tab" href="#forms" role="tab">
                        <i class="fas fa-edit"></i> Data Entry Forms
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="view-tab" data-bs-toggle="tab" href="#view" role="tab">
                        <i class="fas fa-table"></i> View Records
                    </a>
                </li>
            </ul>

            <div class="tab-content" id="myTabContent">
                <!-- Forms Tab -->
                <div class="tab-pane fade show active" id="forms" role="tabpanel">
                    <div class="accordion" id="formsAccordion">
                        <!-- Environmental Data Form -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#environmentalForm">
                                    <i class="fas fa-leaf"></i> Environmental Data Entry
                                </button>
                            </h2>
                            <div id="environmentalForm" class="accordion-collapse collapse"
                                data-bs-parent="#formsAccordion">
                                <div class="accordion-body">
                                    <form action="{{ url_for('add_environmental_data') }}" method="POST"
                                        class="needs-validation" novalidate>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Issue Type</label>
                                                    <select class="form-select" name="issue_type" required>
                                                        <option value="">-- Select Issue Type --</option>
                                                        <option value="Air Quality">Air Quality</option>
                                                        <option value="Water Quality">Water Quality</option>
                                                        <option value="Soil Quality">Soil Quality</option>
                                                        <option value="Waste Management">Waste Management</option>
                                                        <option value="Noise Pollution">Noise Pollution</option>
                                                        <option value="Groundwater Depletion">Groundwater Depletion
                                                        </option>
                                                        <option value="Deforestation">Deforestation</option>
                                                        <option value="Flooding">Flooding</option>
                                                        <option value="Drought">Drought</option>
                                                        <option value="Rainfall Measurement">Rainfall Measurement
                                                        </option>
                                                        <option value="Water Conservation">Water Conservation</option>
                                                        <option value="Erosion Control">Erosion Control</option>
                                                        <option value="Crop Damage">Crop Damage</option>
                                                        <option value="Biodiversity Assessment">Biodiversity Assessment
                                                        </option>
                                                        <option value="Wildlife Monitoring">Wildlife Monitoring</option>
                                                        <option value="Pesticide Contamination">Pesticide Contamination
                                                        </option>
                                                        <option value="Industrial Pollution">Industrial Pollution
                                                        </option>
                                                        <option value="Plastic Pollution">Plastic Pollution</option>
                                                        <option value="E-waste Management">E-waste Management</option>
                                                        <option value="Solar Energy Performance">Solar Energy
                                                            Performance</option>
                                                        <option value="Water Harvesting">Water Harvesting</option>
                                                        <option value="Watershed Management">Watershed Management
                                                        </option>
                                                        <option value="Sanitation Assessment">Sanitation Assessment
                                                        </option>
                                                        <option value="Agricultural Runoff">Agricultural Runoff</option>
                                                        <option value="Weather Event">Weather Event</option>
                                                    </select>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">Description</label>
                                                    <textarea class="form-control" name="description" rows="3"
                                                        required></textarea>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Rainfall (mm)</label>
                                                    <input type="number" step="0.01" class="form-control"
                                                        name="rainfall">
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">Groundwater Level (m)</label>
                                                    <input type="number" step="0.01" class="form-control"
                                                        name="groundwater_level">
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">Pollution Data</label>
                                                    <textarea class="form-control" name="pollution_data"
                                                        rows="3"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-custom-primary">Submit Environmental
                                            Data</button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Census Form -->
                        <!-- Census Form -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#censusForm">
                                    <i class="fas fa-users"></i> Census Data Entry
                                </button>
                            </h2>
                            <div id="censusForm" class="accordion-collapse collapse" data-bs-parent="#formsAccordion">
                                <div class="accordion-body">
                                    <form action="{{ url_for('add_census') }}" method="POST" class="needs-validation"
                                        novalidate>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Year</label>
                                                    <input type="number" class="form-control" name="year" required
                                                        min="2020" max="2025">
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">Population</label>
                                                    <input type="number" class="form-control" name="population"
                                                        required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Demographics</label>
                                                    <textarea class="form-control" name="demographics" rows="3"
                                                        required></textarea>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">Description</label>
                                                    <textarea class="form-control" name="description"
                                                        rows="3"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-custom-primary">Submit Census
                                            Data</button>
                                    </form>
                                </div>
                            </div>
                        </div>



                        <!-- Welfare Scheme Form -->
<div class="accordion-item">
    <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
            data-bs-target="#schemeForm">
            <i class="fas fa-hands-helping"></i> Welfare Scheme Entry
        </button>
    </h2>
    <div id="schemeForm" class="accordion-collapse collapse" data-bs-parent="#formsAccordion">
        <div class="accordion-body">
            <form action="{{ url_for('add_welfare_scheme') }}" method="POST"
                class="needs-validation" novalidate>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Scheme Name <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" name="name" required 
                                maxlength="200" placeholder="Enter scheme name">
                            <div class="invalid-feedback">
                                Please provide a scheme name
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description <span class="text-danger">*</span></label>
                            <textarea class="form-control" name="description" rows="3"
                                maxlength="200" required placeholder="Provide a brief description of the scheme"></textarea>
                            <div class="invalid-feedback">
                                Please provide a scheme description
                            </div>
                            <small class="text-muted">Maximum 200 characters</small>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Scheme Type</label>
                            <select class="form-select" name="scheme_type">
                                <option value="" selected>Select scheme type (optional)</option>
                                <option value="Cash Transfer">Cash Transfer</option>
                                <option value="Subsidy">Subsidy</option>
                                <option value="Insurance">Insurance</option>
                                <option value="Pension">Pension</option>
                                <option value="Scholarship">Scholarship</option>
                                <option value="Infrastructure">Infrastructure</option>
                                <option value="Training">Training & Development</option>
                                <option value="In-Kind">In-Kind Support</option>
                                <option value="Credit">Credit & Loans</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Eligibility Criteria <span class="text-danger">*</span></label>
                            <textarea class="form-control" name="eligibility" rows="3"
                                maxlength="200" required placeholder="Who is eligible for this scheme"></textarea>
                            <div class="invalid-feedback">
                                Please specify eligibility criteria
                            </div>
                            <small class="text-muted">Maximum 200 characters</small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Benefits <span class="text-danger">*</span></label>
                            <textarea class="form-control" name="benefits" rows="3"
                                maxlength="200" required placeholder="What beneficiaries will receive"></textarea>
                            <div class="invalid-feedback">
                                Please describe the benefits
                            </div>
                            <small class="text-muted">Maximum 200 characters</small>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Target Beneficiaries</label>
                            <select class="form-select" name="target_group">
                                <option value="" selected>Select target group (optional)</option>
                                <option value="All Citizens">All Citizens</option>
                                <option value="BPL Families">BPL Families</option>
                                <option value="Farmers">Farmers</option>
                                <option value="Women">Women</option>
                                <option value="Children">Children</option>
                                <option value="Senior Citizens">Senior Citizens</option>
                                <option value="Students">Students</option>
                                <option value="Differently Abled">Differently Abled</option>
                                <option value="SC/ST">SC/ST Communities</option>
                                <option value="Minorities">Minority Groups</option>
                                <option value="Unemployed Youth">Unemployed Youth</option>
                            </select>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Start Date <span class="text-danger">*</span></label>
                                    <input type="date" class="form-control" name="start_date" required>
                                    <div class="invalid-feedback">
                                        Please select start date
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">End Date</label>
                                    <input type="date" class="form-control" name="end_date">
                                    <small class="text-muted">Optional</small>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Implementation Status</label>
                            <select class="form-select" name="implementation_status">
                                <option value="Active" selected>Active</option>
                                <option value="Planned">Planned</option>
                                <option value="Completed">Completed</option>
                                <option value="On Hold">On Hold</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-text mb-3">
                    <span class="text-danger">*</span> Required fields
                </div>
                <button type="submit" class="btn btn-custom-primary">
                    <i class="fas fa-plus-circle me-1"></i> Submit Welfare Scheme
                </button>
            </form>
        </div>
    </div>
</div>

                        <!-- Service Form -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#serviceForm">
                                    <i class="fas fa-cogs"></i> Service Entry
                                </button>
                            </h2>
                            <div id="serviceForm" class="accordion-collapse collapse" data-bs-parent="#formsAccordion">
                                <div class="accordion-body">
                                    <form action="{{ url_for('add_service') }}" method="POST" class="needs-validation"
                                        novalidate>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Service Type</label>
                                                    <select class="form-select" name="type" required>
                                                    <option value="" disabled selected>Select a service type</option>
                                                    
                                                    <optgroup label="Infrastructure Services">
                                                        <option value="Road Repair">Road Repair</option>
                                                        <option value="Road Construction">Road Construction</option>
                                                        <option value="Road Maintenance">Road Maintenance</option>
                                                        <option value="Bridge Repair">Bridge Repair</option>
                                                        <option value="Culvert Installation">Culvert Installation</option>
                                                        <option value="Bus Shelter Construction">Bus Shelter Construction</option>
                                                        <option value="Public Building Maintenance">Public Building Maintenance</option>
                                                        <option value="Panchayat Building Renovation">Panchayat Building Renovation</option>
                                                        <option value="Community Hall Maintenance">Community Hall Maintenance</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Water Services">
                                                        <option value="Water Supply">Water Supply</option>
                                                        <option value="Water Pipeline Repair">Water Pipeline Repair</option>
                                                        <option value="Water Tank Cleaning">Water Tank Cleaning</option>
                                                        <option value="Borewell Installation">Borewell Installation</option>
                                                        <option value="Hand Pump Repair">Hand Pump Repair</option>
                                                        <option value="Drinking Water Testing">Drinking Water Testing</option>
                                                        <option value="Water Supply Extension">Water Supply Extension</option>
                                                        <option value="Irrigation Canal Maintenance">Irrigation Canal Maintenance</option>
                                                        <option value="Water Harvesting Structure">Water Harvesting Structure</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Sanitation & Waste Management">
                                                        <option value="Waste Management">Waste Management</option>
                                                        <option value="Garbage Collection">Garbage Collection</option>
                                                        <option value="Waste Segregation">Waste Segregation</option>
                                                        <option value="Public Toilet Maintenance">Public Toilet Maintenance</option>
                                                        <option value="Sewage Line Inspection">Sewage Line Inspection</option>
                                                        <option value="Sanitation">Sanitation</option>
                                                        <option value="Village Cleaning Drive">Village Cleaning Drive</option>
                                                        <option value="Drain Cleaning">Drain Cleaning</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Public Utilities">
                                                        <option value="Street Lighting">Street Lighting</option>
                                                        <option value="Street Light Installation">Street Light Installation</option>
                                                        <option value="Street Light Maintenance">Street Light Maintenance</option>
                                                        <option value="Solar Light Installation">Solar Light Installation</option>
                                                        <option value="Electricity Connection">Electricity Connection</option>
                                                        <option value="Public Address System">Public Address System</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Administrative Services">
                                                        <option value="Birth Certificate">Birth Certificate</option>
                                                        <option value="Death Certificate">Death Certificate</option>
                                                        <option value="Income Certificate">Income Certificate</option>
                                                        <option value="Caste Certificate">Caste Certificate</option>
                                                        <option value="Land Record Verification">Land Record Verification</option>
                                                        <option value="Property Tax Collection">Property Tax Collection</option>
                                                        <option value="Revenue Record Digitization">Revenue Record Digitization</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Social Welfare Services">
                                                        <option value="Pension Disbursement">Pension Disbursement</option>
                                                        <option value="Healthcare Camp">Healthcare Camp</option>
                                                        <option value="Skill Development Workshop">Skill Development Workshop</option>
                                                        <option value="Village Festival Arrangements">Village Festival Arrangements</option>
                                                        <option value="Anganwadi Center Services">Anganwadi Center Services</option>
                                                        <option value="Widow Pension Processing">Widow Pension Processing</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Agricultural Services">
                                                        <option value="Agricultural Equipment Rental">Agricultural Equipment Rental</option>
                                                        <option value="Farmer Training Program">Farmer Training Program</option>
                                                        <option value="Soil Testing">Soil Testing</option>
                                                        <option value="Crop Damage Assessment">Crop Damage Assessment</option>
                                                        <option value="Seed Distribution">Seed Distribution</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Emergency & Safety Services">
                                                        <option value="Flood Relief">Flood Relief</option>
                                                        <option value="Fire Safety">Fire Safety</option>
                                                        <option value="Medical Emergency Transport">Medical Emergency Transport</option>
                                                        <option value="Disaster Preparedness Training">Disaster Preparedness Training</option>
                                                        <option value="Snake Bite Response">Snake Bite Response</option>
                                                    </optgroup>
                                                    
                                                    <optgroup label="Environmental Services">
                                                        <option value="Tree Plantation">Tree Plantation</option>
                                                        <option value="Pond Cleaning">Pond Cleaning</option>
                                                        <option value="Air Quality Monitoring">Air Quality Monitoring</option>
                                                        <option value="Water Conservation">Water Conservation</option>
                                                        <option value="Animal Vaccination">Animal Vaccination</option>
                                                    </optgroup>
                                                </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Status</label>
                                                    <select class="form-select" name="status" required>
                                                    <option value="" disabled selected>Select a status</option>
                                                    <option value="Pending">Pending</option>
                                                    <option value="Scheduled">Scheduled</option>
                                                    <option value="In Progress">In Progress</option>
                                                    <option value="Active">Active</option>
                                                    <option value="Completed">Completed</option>
                                                    <option value="Cancelled">Cancelled</option>
                                                    <option value="On Hold">On Hold</option>
                                                    <option value="Delayed">Delayed</option>
                                                    <option value="Inactive">Inactive</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-custom-primary">Submit Service</button>
                                    </form>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- View Data Tab -->
                <div class="tab-pane fade" id="view" role="tabpanel">
                    <div class="mb-4">
                        <div class="d-flex flex-wrap gap-2">
                            {% for table in tables %}
                            <button onclick="viewTable('{{ table }}')"
                                class="btn {% if active_table and active_table.name == table %}btn-success{% else %}btn-outline-success{% endif %}">
                                {{ table | title | replace('_', ' ') }}
                            </button>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Add search box -->
                    {% if active_table %}
                    <div class="mb-3">
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-search"></i>
                            </span>
                            <input type="text" class="form-control" id="tableSearch"
                                placeholder="Search in {{ active_table.name | title | replace('_', ' ') }}...">
                        </div>
                    </div>
                    {% endif %}
                    <div class="table-responsive mt-4">
                        {% if active_table %}
                        <h3>{{ active_table.name | title | replace('_', ' ') }}</h3>
                        <table class="table table-striped table-bordered table-hover">
                            <thead class="table-dark">
                                <tr>
                                    {% for column in active_table.columns %}
                                    <th>{{ column | title | replace('_', ' ') }}</th>
                                    {% endfor %}
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for row in active_table.rows %}
                                <tr>
                                    {% for cell in row %}
                                    <td>{{ cell }}</td>
                                    {% endfor %}
                                    <td class="action-buttons">
                                        {% if active_table.name == 'welfare_schemes' %}
                                        <a href="{{ url_for('edit_welfare_scheme', scheme_id=row[0]) }}"
                                            class="btn btn-warning btn-sm">
                                            <i class="fas fa-edit"></i> Edit
                                        </a>
                                        {% elif active_table.name == 'environmental_data' %}
                                        <a href="{{ url_for('edit_environmental_data', data_id=row[0]) }}"
                                            class="btn btn-warning btn-sm">
                                            <i class="fas fa-edit"></i> Edit
                                        </a>
                                        {% elif active_table.name == 'census' %}
                                        <a href="{{ url_for('edit_census', id=row[0]) }}"
                                            class="btn btn-warning btn-sm">
                                            <i class="fas fa-edit"></i> Edit
                                        </a>
                                        {% elif active_table.name == 'service' %}
                                        <a href="{{ url_for('edit_service', id=row[0]) }}"
                                            class="btn btn-warning btn-sm">
                                            <i class="fas fa-edit"></i> Edit
                                        </a>
                                        {% elif active_table.name == 'expenditure' %}
                                        <a href="{{ url_for('edit_expenditure', id=row[0]) }}"
                                            class="btn btn-warning btn-sm">
                                            <i class="fas fa-edit"></i> Edit
                                        </a>
                                        {% elif active_table.name == 'vaccinations' %}

                                        {% elif active_table.name == 'tax' %}

                                        {% elif active_table.name == 'income' %}

                                        {% elif active_table.name == 'citizens' %}

                                        {% elif active_table.name == 'service_requests' %}


                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                        {% else %}
                        <div class="alert alert-info">
                            Please select a table from the options above to view its records.
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

    </div>
    </div>
    <!-- Environmental Data Edit Modal -->
    <div class="modal fade" id="editEnvironmentalModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Environmental Data</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-env-form" method="POST">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Issue Type</label>
                                    <select class="form-select" name="issue_type" required>
                                        <option value="">-- Select Issue Type --</option>
                                        <option value="Air Quality">Air Quality</option>
                                        <option value="Water Quality">Water Quality</option>
                                        <option value="Soil Quality">Soil Quality</option>
                                        <option value="Waste Management">Waste Management</option>
                                        <option value="Noise Pollution">Noise Pollution</option>
                                        <option value="Groundwater Depletion">Groundwater Depletion</option>
                                        <option value="Deforestation">Deforestation</option>
                                        <option value="Flooding">Flooding</option>
                                        <option value="Drought">Drought</option>
                                        <option value="Rainfall Measurement">Rainfall Measurement</option>
                                        <option value="Water Conservation">Water Conservation</option>
                                        <option value="Erosion Control">Erosion Control</option>
                                        <option value="Crop Damage">Crop Damage</option>
                                        <option value="Biodiversity Assessment">Biodiversity Assessment</option>
                                        <option value="Wildlife Monitoring">Wildlife Monitoring</option>
                                        <option value="Pesticide Contamination">Pesticide Contamination</option>
                                        <option value="Industrial Pollution">Industrial Pollution</option>
                                        <option value="Plastic Pollution">Plastic Pollution</option>
                                        <option value="E-waste Management">E-waste Management</option>
                                        <option value="Solar Energy Performance">Solar Energy Performance</option>
                                        <option value="Water Harvesting">Water Harvesting</option>
                                        <option value="Watershed Management">Watershed Management</option>
                                        <option value="Sanitation Assessment">Sanitation Assessment</option>
                                        <option value="Agricultural Runoff">Agricultural Runoff</option>
                                        <option value="Weather Event">Weather Event</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" id="edit-description" name="description" rows="3"
                                        required></textarea>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Rainfall (mm)</label>
                                    <input type="number" step="0.01" class="form-control" id="edit-rainfall"
                                        name="rainfall">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Groundwater Level (m)</label>
                                    <input type="number" step="0.01" class="form-control" id="edit-groundwater"
                                        name="groundwater_level">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Pollution Data</label>
                                    <textarea class="form-control" id="edit-pollution" name="pollution_data"
                                        rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-warning">Update Data</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <script>
        // Update current time display
        $(document).ready(function () {
            // Set initial time
            $('#current-time').text('2025-03-01 19:04:32');

            // Update time every second
            setInterval(function () {
                var time = $('#current-time').text();
                var date = new Date(time);
                date.setSeconds(date.getSeconds() + 1);
                $('#current-time').text(date.toISOString().slice(0, 19).replace('T', ' '));
            }, 1000);

            // Initialize tooltips
            $('[data-bs-toggle="tooltip"]').tooltip();
        });

        // Table editing functions
        function editWelfareScheme(id) {
            window.location.href = `/edit_welfare_scheme/${id}`;
        }

        function editEnvironmentalData(id) {
            window.location.href = `/edit_environmental_data/${id}`;
        }

        function editCensus(id) {
            window.location.href = `/edit_census/${id}`;
        }

        function editService(id) {
            window.location.href = `/edit_service/${id}`;
        }

        // Form validation
        (function () {
            'use strict'
            var forms = document.querySelectorAll('.needs-validation')
            Array.prototype.slice.call(forms).forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
        })()

        // Add this in your existing script section
        function viewTable(tableName) {
            // Switch to the view tab first
            $('#view-tab').tab('show');

            // Navigate to the table view
            window.location.href = "{{ url_for('panchayat_employee_table') }}?table_name=" + tableName;
        }

        // Add this function for editing environmental data
        function editEnvironmentalData(id) {
            $('#editEnvironmentalModal').modal('show');
            fetch(`/get_environmental_data/${id}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('edit-env-form').action = `/edit_environmental_data/${id}`;
                    document.getElementById('edit-issue-type').value = data.issue_type;
                    document.getElementById('edit-description').value = data.description;
                    document.getElementById('edit-rainfall').value = data.rainfall;
                    document.getElementById('edit-groundwater').value = data.groundwater_level;
                    document.getElementById('edit-pollution').value = data.pollution_data;
                })
                .catch(error => console.error('Error:', error));
        }

        // Update these functions in your script section
        function editWelfareScheme(schemeId) {
            fetch(`/get_welfare_scheme/${schemeId}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('edit-scheme-form').action = `/update_welfare_scheme/${schemeId}`;
                    document.getElementById('edit-scheme-name').value = data.name;
                    document.getElementById('edit-scheme-description').value = data.description;
                    document.getElementById('edit-scheme-eligibility').value = data.eligibility;
                    document.getElementById('edit-scheme-benefits').value = data.benefits;
                    document.getElementById('edit-scheme-start-date').value = data.start_date;
                    document.getElementById('edit-scheme-end-date').value = data.end_date;
                    $('#editWelfareSchemeModal').modal('show');
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error fetching scheme details');
                });
        }

        // Update time display function
        $(document).ready(function () {
            // Set initial time
            $('#current-time').text('2025-03-01 19:19:23');

            // Update time every second
            setInterval(function () {
                var time = $('#current-time').text();
                var date = new Date(time);
                date.setSeconds(date.getSeconds() + 1);
                var formattedTime = date.getFullYear() + '-' +
                    String(date.getMonth() + 1).padStart(2, '0') + '-' +
                    String(date.getDate()).padStart(2, '0') + ' ' +
                    String(date.getHours()).padStart(2, '0') + ':' +
                    String(date.getMinutes()).padStart(2, '0') + ':' +
                    String(date.getSeconds()).padStart(2, '0');
                $('#current-time').text(formattedTime);
            }, 1000);

            // Check if we should show the view tab
            if (window.location.search.includes('table_name')) {
                $('#view-tab').tab('show');
            }
        });
        // Add this to your existing script section
        function searchTable() {
            let input = document.getElementById('tableSearch');
            let filter = input.value.toLowerCase();
            let table = document.querySelector('.table');
            let tr = table.getElementsByTagName('tr');

            // Loop through all table rows, starting from index 1 to skip the header
            for (let i = 1; i < tr.length; i++) {
                let td = tr[i].getElementsByTagName('td');
                let found = false;

                // Loop through all cells in the row
                for (let j = 0; j < td.length - 1; j++) { // -1 to exclude the Actions column
                    let cell = td[j];
                    if (cell) {
                        let textValue = cell.textContent || cell.innerText;
                        if (textValue.toLowerCase().indexOf(filter) > -1) {
                            found = true;
                            break;
                        }
                    }
                }

                // Show/hide the row based on whether the search term was found
                tr[i].style.display = found ? '' : 'none';
            }
        }

        // Add event listener to search input
        document.addEventListener('DOMContentLoaded', function () {
            let searchInput = document.getElementById('tableSearch');
            if (searchInput) {
                searchInput.addEventListener('keyup', searchTable);
            }
        });

        // Update the viewTable function to ensure search functionality is initialized after table load
        function viewTable(tableName) {
            // Switch to the view tab first
            $('#view-tab').tab('show');

            // Navigate to the table view
            window.location.href = "{{ url_for('panchayat_employee_table') }}?table_name=" + tableName;

            // Initialize search functionality after table load
            document.addEventListener('DOMContentLoaded', function () {
                let searchInput = document.getElementById('tableSearch');
                if (searchInput) {
                    searchInput.addEventListener('keyup', searchTable);
                }
            });
        }

    </script>

    <!-- Welfare Scheme Edit Modal -->
<div class="modal fade" id="editWelfareSchemeModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-warning">
                <h5 class="modal-title">Edit Welfare Scheme</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="edit-scheme-form" method="POST">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Scheme Name</label>
                                <input type="text" class="form-control" id="edit-scheme-name" name="name" required>
                                <div class="invalid-feedback">
                                    Please provide a scheme name
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="edit-scheme-description" name="description"
                                    rows="3" required></textarea>
                                <div class="invalid-feedback">
                                    Please provide a scheme description
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Category</label>
                                <select class="form-select" id="edit-scheme-category" name="category" required>
                                    <option value="" disabled>Select a category</option>
                                    <option value="Social Security">Social Security</option>
                                    <option value="Education">Education</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Housing">Housing</option>
                                    <option value="Women Empowerment">Women Empowerment</option>
                                    <option value="Child Welfare">Child Welfare</option>
                                    <option value="Skill Development">Skill Development</option>
                                    <option value="Financial Inclusion">Financial Inclusion</option>
                                    <option value="Rural Development">Rural Development</option>
                                    <option value="Disability Support">Disability Support</option>
                                    <option value="Tribal Welfare">Tribal Welfare</option>
                                    <option value="Water & Sanitation">Water & Sanitation</option>
                                    <option value="Digital Literacy">Digital Literacy</option>
                                    <option value="Other">Other</option>
                                </select>
                                <div class="invalid-feedback">
                                    Please select a category
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Eligibility Criteria</label>
                                <textarea class="form-control" id="edit-scheme-eligibility" name="eligibility"
                                    rows="3" required></textarea>
                                <div class="invalid-feedback">
                                    Please specify eligibility criteria
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Benefits</label>
                                <textarea class="form-control" id="edit-scheme-benefits" name="benefits" rows="3"
                                    required></textarea>
                                <div class="invalid-feedback">
                                    Please describe the benefits
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Implementation Agency</label>
                                <select class="form-select" id="edit-scheme-agency" name="agency">
                                    <option value="Central Government">Central Government</option>
                                    <option value="State Government">State Government</option>
                                    <option value="Local Government/Panchayat">Local Government/Panchayat</option>
                                    <option value="Public-Private Partnership">Public-Private Partnership</option>
                                    <option value="NGO Partnership">NGO Partnership</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Payment Frequency</label>
                                <select class="form-select" id="edit-scheme-frequency" name="payment_frequency">
                                    <option value="One-time">One-time</option>
                                    <option value="Monthly">Monthly</option>
                                    <option value="Quarterly">Quarterly</option>
                                    <option value="Half-yearly">Half-yearly</option>
                                    <option value="Annual">Annual</option>
                                    <option value="As-needed">As-needed</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Start Date</label>
                                        <input type="date" class="form-control" id="edit-scheme-start-date"
                                            name="start_date" required>
                                        <div class="invalid-feedback">
                                            Please select start date
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">End Date</label>
                                        <input type="date" class="form-control" id="edit-scheme-end-date" name="end_date">
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="edit-scheme-status" name="status">
                                    <option value="Active">Active</option>
                                    <option value="Upcoming">Upcoming</option>
                                    <option value="Completed">Completed</option>
                                    <option value="Suspended">Suspended</option>
                                    <option value="Under Review">Under Review</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-save me-1"></i> Update Scheme
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</body>

</html>